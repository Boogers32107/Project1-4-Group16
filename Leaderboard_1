import json

from pathlib import Path
folder=Path(__file__).resolve().parent

score = 0
new_data = {"name": "Bob", "score": score + 1}  # Fix set issue

# Read existing data
try:
    with open(Path(folder,"data.json"), "r") as file:
        data = json.load(file)
except (FileNotFoundError, json.JSONDecodeError):
    data = []  # If file doesn't exist or is empty, start with an empty list

# Ensure data is a list
if not isinstance(data, list):
    data = [data]

# Check if the user already exists and update score
found = False
for entry in data:
    if entry.get("name") == new_data["name"]:
        entry["score"] = int(entry["score"]) + 1  # Ensure integer addition
        found = True
        break

# If the user was not found, add new entry
if not found:
    data.append(new_data)

# Write back to file
with open(Path(folder,"data.json"), "w") as file:
    json.dump(data, file, indent=4)
